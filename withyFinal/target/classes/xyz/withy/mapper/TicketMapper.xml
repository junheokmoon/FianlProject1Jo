<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="xyz.withy.mapper.TicketMapper">

	<insert id="insertTicket">
	<!-- 생각해보니 티켓은 시퀀스 않쓰는구나 ㅋㅋㅋ 
	 -->
		<selectKey resultType="int" keyProperty="ticketNo" order="BEFORE"> 
		select ticket_seq.nextval from dual
		</selectKey>
		insert into ticket values(${ticketCode}, ${ticketPrice}, ${ticketImage1}
		, ${ticketImage2}, ${ticketOttNo}, ${ticketMonth} , 1 , ${ticketNo})
	</insert>
	
	<update id="updateTicket">
		update ticket set ticket_code = ${ticketCode}, ticket_price =${ticketPrice}, ticket_image1=${ticketImage1}
		, ticket_image2=${ticketImage2}, ticket_ott_no=${ticketOttNo}, ticket_month=${ticketMonth}
		where ticket_code = ${ticketCode}
	</update>

	<update id="deleteTicket">
		update ticket set ticket_status = 2 where ticket_code = ${ticketCode}
	</update>
	
	<delete id="realDeleteTicket">
		delect from ticket where ticket_code = ${ticketCode}
	</delete>
	
	<update id="recoverTicket">
		update ticket set ticket_status = 1 where ticket_code = ${ticketCode}
	</update>
	
	<select id="selectTicket" resultType="TicketDTO">
		select ticket_code, ticket_price, ticket_image1, ticket_image2, ticket_ott_no
		, ticket_month, ticket_status from ticket where ticke_code = ${ticketCode}
	</select>
	
	<select id="selectTicketCount"  resultType="int">
		select count(*) from ticket
	</select>
	
	<select id="selectTicketList" resultType="TicketDTO">
	
	
	
		select ticket_code, ticket_price, ticket_image1, ticket_image2, ticket_ott_no
		, ticket_month, ticket_status from ticket order by ticket_no desc
	</select>
	
	<select id="selectTicketPageList" resultType="TicketDTO">
		select * from (rownum rn ticket.* (select ticket_code, ticket_price, ticket_image1, ticket_image2, ticket_ott_no
		, ticket_month, ticket_status from ticket order by ticket_no desc)ticket) where rn between #{startRow} and #{endRow}
	</select>
	




</mapper>